############## BAR ##############
	sketchybar -m --bar \
		height=30 \
		position=bottom \
		padding_left=0 \
		padding_right=0 \
		color=0x30000000 \
		shadow=off \
		topmost=off

############## GLOBAL DEFAULTS ##############
	sketchybar -m --default \
		updates=when_shown \
		drawing=on \
		cache_scripts=on \
		icon.font="Hack Nerd Font:Bold:16.0" \
		icon.color=0xffffffff \
		label.font="Rajdhani:SemiBold:16.0" \
		label.color=0xffeceff4 \
		label.highlight_color=0xff8CABC8

############## SPACE DEFAULTS ##############
	sketchybar -m --default \
		label.padding_left=5 \
		label.padding_right=2 \
		icon.padding_left=8 \
		label.padding_right=5


############## PRIMARY DISPLAY SPACES ##############
	# SPACE 1: CODE ICON
	sketchybar -m --add space code left \
		--set code associated_display=1 \
		--set code associated_space=1 \
		--set code icon.padding_left=5 \
		--set code icon.padding_right=2 \
		--set code label.padding_right=5 \
		--set code label.padding_left=0 \
		--set code label.color=0xffeceff4 \
		--set code background.color=0x00000000  \
		--set code background.height=21 \
		--set code background.padding_left=12 \
		--set code update_freq=1 \
		--set code click_script="yabai -m space --focus 1" \
		--set code script="~/.config/sketchybar/plugins/space.sh" \
        --subscribe code window_focus front_app_switched space_change title_change\

	# SPACE 2: WEB ICON
	sketchybar -m --add space web left \
		--set web icon.highlight_color=0xff8CABC8 \
		--set web associated_display=1 \
		--set web associated_space=2 \
		--set web icon.padding_left=5 \
		--set web icon.padding_right=2 \
		--set web label.padding_right=5 \
		--set web label.padding_left=0 \
		--set web label.color=0xffeceff4 \
		--set web background.color=0x00000000  \
		--set web background.height=21 \
		--set web background.padding_left=7 \
		--set web update_freq=1 \
		--set web click_script="yabai -m space --focus 2" \
		--set web script="~/.config/sketchybar/plugins/space.sh" \
        --subscribe web window_focus front_app_switched space_change title_change\

	# SPACE 3: research ICON
	sketchybar -m --add space research left \
		--set research icon.highlight_color=0xff8CABC8 \
		--set research associated_display=1 \
		--set research associated_space=3 \
		--set research icon.padding_left=5 \
		--set research icon.padding_right=2 \
		--set research label.padding_right=5 \
		--set research label.padding_left=0 \
		--set research label.color=0xffeceff4 \
		--set research background.color=0x00000000  \
		--set research background.height=21 \
		--set research background.padding_left=7 \
		--set research update_freq=1 \
		--set research click_script="yabai -m space --focus 3" \
		--set research script="~/.config/sketchybar/plugins/space.sh" \
        --subscribe research window_focus front_app_switched space_change title_change\

	# SPACE 4: CHAT ICON
	sketchybar -m --add space office left \
		--set office icon.highlight_color=0xff8CABC8 \
		--set office associated_display=1 \
		--set office associated_space=4 \
		--set office icon.padding_left=5 \
		--set office icon.padding_right=2 \
		--set office label.padding_right=5 \
		--set office label.padding_left=0 \
		--set office label.color=0xffeceff4 \
		--set office background.color=0x00000000  \
		--set office background.height=21 \
		--set office background.padding_left=7 \
		--set office update_freq=1 \
		--set office click_script="yabai -m space --focus 4" \
		--set office script="~/.config/sketchybar/plugins/space.sh" \
        --subscribe office window_focus front_app_switched space_change title_change\

	# SPACE 5: MUSIC ICON
	sketchybar -m --add space enjoy left \
		--set enjoy icon.highlight_color=0xff8CABC8 \
		--set enjoy associated_display=1 \
		--set enjoy associated_space=5 \
		--set enjoy icon.padding_left=5 \
		--set enjoy icon.padding_right=2 \
		--set enjoy label.padding_right=5 \
		--set enjoy label.padding_left=0 \
		--set enjoy label.color=0xffeceff4 \
		--set enjoy background.color=0x00000000  \
		--set enjoy background.height=21 \
		--set enjoy background.padding_left=7 \
		--set enjoy update_freq=1 \
		--set enjoy click_script="yabai -m space --focus 5" \
		--set enjoy script="~/.config/sketchybar/plugins/space.sh" \
        --subscribe enjoy window_focus front_app_switched space_change title_change\

	# SPACE 6: OTHER ICON
	sketchybar -m --add space more left \
		--set more icon.highlight_color=0xff8CABC8 \
		--set more associated_display=1 \
		--set more associated_space=6 \
		--set more icon.padding_left=5 \
		--set more icon.padding_right=2 \
		--set more label.padding_right=5 \
		--set more label.padding_left=0 \
		--set more label.color=0xffeceff4 \
		--set more background.color=0x00000000  \
		--set more background.height=21 \
		--set more background.padding_left=7 \
		--set more update_freq=1 \
		--set more click_script="yabai -m space --focus 6" \
		--set more script="~/.config/sketchybar/plugins/space.sh" \
		--set more label.font="Rajdhani:Bold:16.0" \
        --subscribe more window_focus front_app_switched space_change title_change\


	# SPACE x: detect the second monitor
	# sketchybar -m --add space detect_monitor left \
	# 	--set detect_monitor associated_display=1 \
	# 	--set detect_monitor update_freq=1 \
	# 	--set detect_monitor script="~/.config/sketchybar/plugins/space_on_display2.sh" \
    #     --subscribe detect_monitor window_focus front_app_switched space_change title_change\

    SPACE_NAMES=(code web research office enjoy more seven eight nine ten)
    MORE_DISPLAYS=$(yabai -m query --displays |  jq '.[1:]' | jq '.[].index')
    for did in ${MORE_DISPLAYS[@]}; do
        # SPACE 7+: OTHER ICON
        SPACE_IDS=$(yabai -m query --displays --display $did | jq '.spaces' |jq -r '.[]')
        for sid in ${SPACE_IDS[@]}; do
            EXIST_BARS=$(sketchybar --query bar |jq '.items' | jq -r '.[]')
            SPACE_NM=${SPACE_NAMES[$sid-1]}
            if [[ ! "${EXIST_BARS[@]}"  =~ "$SPACE_NM" ]]
            then
                sketchybar -m --add space seven left \
                    --set seven icon.highlight_color=0xff8CABC8 \
                    --set seven associated_display=$did \
                    --set seven associated_space=$sid \
                    --set seven icon.padding_left=5 \
                    --set seven icon.padding_right=2 \
                    --set seven label.padding_right=5 \
                    --set seven label.padding_left=0 \
                    --set seven label.color=0xffeceff4 \
                    --set seven label.font="Rajdhani:Bold:16.0" \
                    --set seven background.color=0x00000000  \
                    --set seven background.height=21 \
                    --set seven background.padding_left=7 \
                    --set seven update_freq=1 \
                    --set seven click_script="yabai -m space --focus $sid" \
                    --set seven script="~/.config/sketchybar/plugins/space2.sh" \
                    --subscribe seven window_focus front_app_switched space_change title_change display_change
            fi
        done
    done


############## ITEM DEFAULTS ###############
	sketchybar -m --default \
		label.padding_left=2 \
		icon.padding_right=2 \
		icon.padding_left=6 \
		label.padding_right=6

############## RIGHT ITEMS ##############
   # show dock
	sketchybar -m --add item showdock right \
        --set showdock icon= \
		--set showdock icon.padding_left=4 \
		--set showdock icon.padding_right=0 \
		--set showdock label='dock' \
		--set showdock update_freq=1 \
        --set showdock script=""\
        --set showdock click_script="~/.config/sketchybar/plugins/dock.sh click"\
        # --subscribe showdock mouse.clicked mouse.exited mouse.entered mouse.exited.global   \
        # --set showdock script="~/.config/sketchybar/plugins/showdesktop.sh"\

   # show desktop
	sketchybar -m --add item showdesktop right \
        --set showdesktop icon= \
		--set showdesktop icon.padding_left=4 \
		--set showdesktop icon.padding_right=0 \
		--set showdesktop label='desktop' \
		--set showdesktop update_freq=1 \
        --set showdesktop script=""\
        --set showdesktop click_script="osascript -e 'tell application \"System Events\" to keystroke \"d\" using {control down, option down, command down}'"\
        # --subscribe showdesktop mouse.clicked mouse.exited mouse.entered mouse.exited.global   \
        # --set showdesktop script="~/.config/sketchybar/plugins/showdesktop.sh"\

   # show launchpad
	sketchybar -m --add item launchpad right \
        --set launchpad icon= \
		--set launchpad icon.padding_left=4 \
		--set launchpad icon.padding_right=0 \
		--set launchpad update_freq=10000 \
		--set launchpad label='launchpad' \
        --set launchpad script=""\
        --set launchpad click_script="osascript -e 'tell app \"LaunchPad\" to launch'"\

    # screen saver
	sketchybar -m --add item screensaver right \
        --set screensaver icon=冷 \
		--set screensaver icon.padding_left=4 \
		--set screensaver icon.padding_right=0 \
		--set screensaver update_freq=10000 \
		--set screensaver label='screensaver' \
        --set screensaver script=""\
        --set screensaver click_script="osascript -e 'tell application \"System Events\" to keystroke \"s\" using {control down, command down,option down} '"\

    # display & monitor settings
	sketchybar -m --add item monitorsettings right \
        --set monitorsettings icon= \
		--set monitorsettings icon.padding_left=4 \
		--set monitorsettings icon.padding_right=0 \
		--set monitorsettings update_freq=10000 \
		--set monitorsettings label='display' \
        --set monitorsettings script=""\
        --set monitorsettings click_script="osascript -e 'tell application \"System Preferences\" to activate' -e 'tell application \"System Preferences\" to set current pane to pane \"com.apple.preference.displays\"'"\


    # logout
	sketchybar -m --add item logout right \
        --set logout icon=﫼 \
		--set logout icon.padding_left=4 \
		--set logout icon.padding_right=0 \
		--set logout update_freq=10000 \
		--set logout label='logout' \
        --set logout script=""\
        --set logout click_script="~/.config/sketchybar/plugins/logout.sh click"\

    # open windows
	sketchybar -m --add item openwin11 right \
        --set openwin11 icon= \
		--set openwin11 icon.padding_left=4 \
		--set openwin11 icon.padding_right=0 \
		--set openwin11 label='Win11' \
		--set openwin11 update_freq=100 \
        --set openwin11 script="~/.config/sketchybar/plugins/openwin11.sh"\
        --set openwin11 click_script="~/.config/sketchybar/plugins/openwin11.sh click"\

    # MAIL
    sketchybar -m --add item mail right \
        --set mail update_freq=60 \
        --set mail icon=􀍜 \
        --set mail label.padding_right=8 \
        --set mail background.padding_right=0            \
        --set mail label="!" \
        --set mail script="~/.config/sketchybar/plugins/mail.sh" \
        --set mail click_script="~/.config/sketchybar/plugins/mail.sh click" \


	# caffeinate from https://github.com/FelixKratz/SketchyBar/discussions/12?sort=new#discussioncomment-1222059
	sketchybar -m --add item caffeinate right \
		--set caffeinate icon.padding_left=4 \
		--set caffeinate icon.padding_right=0 \
		--set caffeinate update_freq=100 \
        --set caffeinate script="~/.config/sketchybar/plugins/caffeinate.sh"\
        --set caffeinate click_script="~/.config/sketchybar/plugins/caffeinate.sh click"

	# MIC STATUS
	sketchybar -m --add item mic right \
		--set mic icon.padding_left=4 \
		--set mic icon.padding_right=4 \
		--set mic label.padding_right=0 \
		--set mic label.padding_left=0 \
		--set mic label.color=0xffeceff4 \
		--set mic update_freq=3 \
		--set mic script="~/.config/sketchybar/plugins/mic.sh" \
		--set mic click_script="~/.config/sketchybar/plugins/mic.sh click"


############## FINALIZING THE SETUP ##############
sketchybar -m --update

echo "sketchybar configuration loaded.."
